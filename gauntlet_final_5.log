
==================================================
   SEATTLE BETA GAUNTLET (OMEGA PROTOCOL v9D)
==================================================
SCENARIO | RESULT   | STATE        | LEDGER     | NOTES
---------|----------|--------------|------------|------------------------
[ENV] Loading Environment: LOCAL
[08:05:24] [32mINFO[39m: [36mRunning Enterprise Environment Loader[39m
    module: "service"
    mode: "local"
    stripeMode: "test"
    payoutsEnabled: false
    identityStrict: false
| A1   | PASS     | cancelled    | VERIFY     | Cancellation accepted
[08:05:25] [32mINFO[39m: [36mTask cancelled during active phase - Refund Logic Implicit[39m
    module: "service"
    taskId: "71106927-b41e-47f9-9388-a09156eb4a39"
    action: "cancel"
[08:05:25] [33mWARN[39m: [36mTask Cancelled by Poster[39m
    module: "service"
    taskId: "71106927-b41e-47f9-9388-a09156eb4a39"
    reason: "Changed mind"
[08:05:26] [31mERROR[39m: [36mTemporal Guard Check Failed - Failing Closed (Reject)[39m
    module: "TemporalGuard"
    targetId: "6ea7d196-4bba-43a7-96e0-fc51237a0a61"
    error: {
      "name": "Layerr"
    }
[08:05:26] [31mERROR[39m: [36mSaga Failed - Initiating Compensation Flow[39m
    module: "service"
    taskId: "6ea7d196-4bba-43a7-96e0-fc51237a0a61"
    eventType: "DISPUTE_OPEN"
    err: {
      "type": "Error",
      "message": "Temporal Guard Blocked: Event 5a0ae56d-260c-4367-8c7d-da3a0e421802 is older than last committed state.",
      "stack":
          Error: Temporal Guard Blocked: Event 5a0ae56d-260c-4367-8c7d-da3a0e421802 is older than last committed state.
              at validateGuards (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:234:15)
              at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
              at async <anonymous> (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:296:13)
              at async transaction (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/db/index.ts:44:24)
              at async Object.handle (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:287:28)
              at async DisputeServiceClass.createDispute (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/DisputeService.ts:115:17)
              at async runA3 (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/tests/omega/seattle-gauntlet.ts:298:21)
              at async runGauntlet (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/tests/omega/seattle-gauntlet.ts:439:9)
    }
[08:05:26] [31mERROR[39m: [36mFailed to transition Money Engine state to DISPUTE_OPEN[39m
    module: "service"
    taskId: "6ea7d196-4bba-43a7-96e0-fc51237a0a61"
    err: {
      "type": "Error",
      "message": "Temporal Guard Blocked: Event 5a0ae56d-260c-4367-8c7d-da3a0e421802 is older than last committed state.",
      "stack":
          Error: Temporal Guard Blocked: Event 5a0ae56d-260c-4367-8c7d-da3a0e421802 is older than last committed state.
              at validateGuards (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:234:15)
              at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
              at async <anonymous> (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:296:13)
              at async transaction (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/db/index.ts:44:24)
              at async Object.handle (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:287:28)
              at async DisputeServiceClass.createDispute (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/DisputeService.ts:115:17)
              at async runA3 (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/tests/omega/seattle-gauntlet.ts:298:21)
              at async runGauntlet (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/tests/omega/seattle-gauntlet.ts:439:9)
    }
[08:05:26] [32mINFO[39m: [36mDispute created and Money Engine notified[39m
    module: "service"
    disputeId: "aebb52a2-896e-4c6d-b977-ba5686a17088"
    taskId: "6ea7d196-4bba-43a7-96e0-fc51237a0a61"
| A3   | FAIL     | completed    | UNK        | State not disputed
| A4   | FAIL     | active       | UNK        | Task not reset
[08:05:27] [33mWARN[39m: [36mTask Abandoned by Hustler[39m
    module: "service"
    taskId: "8f1abc6b-06d1-4f9a-811b-1481370d6c41"
    hustlerId: "198f0d58-887b-4d11-8fbd-c7e7b7e4d495"
| B6   | FAIL     | ERROR        | UNK        | Temporal Guard Blocked: Event 8838fdc9-b3f8-40e1-93e6-281ef41707c8 is older than last committed state.
[08:05:27] [31mERROR[39m: [36mTemporal Guard Check Failed - Failing Closed (Reject)[39m
    module: "TemporalGuard"
    targetId: "7f17b756-a963-4d2f-b953-5b7ad33f84f9"
    error: {
      "name": "Layerr"
    }
[08:05:27] [31mERROR[39m: [36mSaga Failed - Initiating Compensation Flow[39m
    module: "service"
    taskId: "7f17b756-a963-4d2f-b953-5b7ad33f84f9"
    eventType: "HOLD_ESCROW"
    err: {
      "type": "Error",
      "message": "Temporal Guard Blocked: Event 8838fdc9-b3f8-40e1-93e6-281ef41707c8 is older than last committed state.",
      "stack":
          Error: Temporal Guard Blocked: Event 8838fdc9-b3f8-40e1-93e6-281ef41707c8 is older than last committed state.
              at validateGuards (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:234:15)
              at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
              at async <anonymous> (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:296:13)
              at async transaction (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/db/index.ts:44:24)
              at async Object.handle (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:287:28)
              at async runB6 (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/tests/omega/seattle-gauntlet.ts:360:9)
              at async runGauntlet (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/tests/omega/seattle-gauntlet.ts:441:9)
    }
[08:05:27] [41mFATAL[49m: [36m‚ö†Ô∏è KILL SWITCH TRIGGERED - SYSTEM FREEZING ‚ö†Ô∏è[39m
    module: "KillSwitch"
    reason: "TEST_SIMULATION"
    metadata: {
      "desc": "Gauntlet Test"
    }
| C9   | PASS     | blocked      | SAFE       | KillSwitch blocked execution
[08:05:27] [32mINFO[39m: [36mKillSwitch Resolved - Resuming Operations[39m
    module: "KillSwitch"
[08:05:28] [33mWARN[39m: [36mADMIN OVERRIDE INITIATED[39m
    module: "service"
    input: {
      "adminId": "admin_9898bde0-274a-4995-9be6-d02864ec1032",
      "taskId": "6cfab1c5-d301-41eb-98a6-f17dabe22364",
      "action": "force_cancel",
      "reason": "Gauntlet Override"
    }
[08:05:28] [31mERROR[39m: [36mDatabase query failed[39m
    message: "duplicate key value violates unique constraint \"ledger_locks_pkey\""
    stack: "NeonDbError: duplicate key value violates unique constraint \"ledger_locks_pkey\"\n    at dr.execute (file:///Users/sebastiandysart/HustleXP/hustlexp-ai-backend/node_modules/@neondatabase/serverless/index.mjs:1298:10)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/db/index.ts:68:24)\n    at async Function.acquire (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/ledger/LedgerLockService.ts:23:13)\n    at async Function.acquireBatch (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/ledger/LedgerLockService.ts:83:32)\n    at async Object.handle (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:275:19)\n    at async <anonymous> (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/AdminService.ts:102:25)\n    at async transaction (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/db/index.ts:44:24)\n    at async AdminServiceClass.overrideTaskState (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/AdminService.ts:36:13)\n    at async runD12 (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/tests/omega/seattle-gauntlet.ts:408:9)"
    query: "\n                INSERT INTO ledger_locks (resource_id, owner_ulid, expires_at)\n                VALU"
[LedgerLock] Batch acquisition failed. Rolling back 0 locks.
[08:05:28] [31mERROR[39m: [36mAdmin Override Failed[39m
    module: "service"
    taskId: "6cfab1c5-d301-41eb-98a6-f17dabe22364"
    error: {}
| D12  | FAIL     | ERROR        | UNK        | [LedgerLock] Resource task:6cfab1c5-d301-41eb-98a6-f17dabe22364 is locked by tx admin-0e20b90d-ad8a-4300-b6d8-d5673518c0b6

==================================================
   EXECUTION COMPLETE
==================================================

