=========================================
   M4 SURGICAL TEST RUNNER (NEON/SER)    
=========================================
Environment: DATABASE_URL aligned to M4 Target (Dynamic Import Mode).
Environment: SERIALIZABLE Enforced.

>> RUNNING: Race Release (Option A: 500 Manual Clients - No Pool)
[04:18:08] [32mINFO[39m: [36m>>> STARTING M4 RACE RELEASE (OPTION A - STRICT) <<<[39m
    module: "service"
[04:18:09] [32mINFO[39m: [36mPreparing ledger transaction: PAYOUT_RELEASE[39m
    module: "service"
    txId: "01KCAYWBNMCA8YM77BTPBE8H8Z"
    type: "LedgerPrepare"
[04:18:09] [32mINFO[39m: [36mTransaction PREPARED (Pending)[39m
    module: "service"
    txId: "01KCAYWBNMCA8YM77BTPBE8H8Z"
    type: "LedgerPrepare"
[04:18:09] [32mINFO[39m: [36mTransaction COMMITTED[39m
    module: "service"
    txId: "01KCAYWBNMCA8YM77BTPBE8H8Z"
    type: "LedgerCommit"
   [PASS] 1189ms

>> RUNNING: Saga Fault Injection (Stripe Down)
[04:18:10] [32mINFO[39m: [36m>>> STARTING M4 SAGA FAULTS (STRIPE DOWN) <<<[39m
    module: "service"
   [PASS] 1035ms

>> RUNNING: Ledger Consistency & Integrity
[04:18:11] [32mINFO[39m: [36mPreparing ledger transaction: PAYOUT_RELEASE[39m
    module: "service"
    txId: "01KCAYWCYV1ZQBMXT1S54MX99X"
    type: "LedgerPrepare"
[04:18:11] [33mWARN[39m: [36mDuplicate transaction detected (Idempotency). Returning existing.[39m
    module: "service"
    txId: "01KCAYWCYV1ZQBMXT1S54MX99X"
    type: "LedgerPrepare"
[04:18:11] [31mERROR[39m: [36mSaga Failed from Engine[39m
    module: "service"
    taskId: "d524adfc-3297-4326-aa70-1d9089fb9e2b"
    eventType: "RELEASE_PAYOUT"
    err: {
      "type": "Error",
      "message": "stripe_server_error",
      "stack":
          Error: stripe_server_error
              at Object.capture (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/tests/m4/cases/saga-faults.ts:83:46)
              at effectReleasePayout (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:136:44)
              at executeStripeEffects (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:82:26)
              at Object.handle (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/services/StripeMoneyEngine.ts:320:31)
              at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
              at async Object.run (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/tests/m4/cases/saga-faults.ts:92:13)
              at async main (/Users/sebastiandysart/HustleXP/hustlexp-ai-backend/src/tests/m4/m4-runner.ts:73:28)
    }
   [PASS] 91ms

=========================================
   M4 FINAL REPORT                       
=========================================
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (index) â”‚ Case                                                    â”‚ Status â”‚ Time     â”‚ Stats                                                                           â”‚ Error â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0       â”‚ 'Race Release (Option A: 500 Manual Clients - No Pool)' â”‚ 'PASS' â”‚ '1189ms' â”‚ '{"successes":1,"failures":9,"processedCount":1,"finalVersion":2,"workers":10}' â”‚ ''    â”‚
â”‚ 1       â”‚ 'Saga Fault Injection (Stripe Down)'                    â”‚ 'PASS' â”‚ '1035ms' â”‚ '{"status":"Correctly Rolled Back"}'                                            â”‚ ''    â”‚
â”‚ 2       â”‚ 'Ledger Consistency & Integrity'                        â”‚ 'PASS' â”‚ '91ms'   â”‚ '{"checkedTransactions":"ALL"}'                                                 â”‚ ''    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜

Status: CERTIFIED (M4).
